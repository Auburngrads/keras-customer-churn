hchart(hcaes(x = date_trunc, y= ml), type = 'line') %>%
hc_title(text = 'Share of member searches with ML only filter selected - VB')
vbPeek('storyblocks.subscription_campaign_profiles')
vbPeek('analytics.sessions')
vbPeek('analytics.page_views')
vbPeek('analytics.channel_mappings')
vbTables('analyitcs') %>% filter(grepl('channel', table_name))
vbTables('analyitcs') %>% filter(grepl('map', table_name))
vbTables() %>% filter(grepl('map', table_name))
vbTables() %>% filter(grepl('channel', table_name))
vbPeek('analytics.channel_lookup')
vbQuery('select count(*) from analytics.channel_lookup')
vbQuery('select * from analytics.channel_lookup where subchannel <> subchannel2 limit 100')
vbQuery('select distinct channel from analytics.channel_lookup where subchannel <> subchannel2 limit 100')
vbQuery('select distinct channel, subchannel, subchannel2 from analytics.channel_lookup where subchannel <> subchannel2 limit 100')
vbQuery("select * from abtesting.abtest_visitor_metrics limit 5")
test = vbQuery("select * from abtesting.abtest_visitor_metrics where site_test_id = 3450 limit 100", 'prod')
head(test)
test = vbQuery("select * from abtesting.abtest_visitor_metrics where site_test_id = 3450 limit 100", 'prod')
head(test)
test = vbQuery("select * from abtesting.abtest_visitor_metrics where site_test_id = 3450 limit 100")
head(test)
vbPeek('analytics.sessions_v2', 'prod')
vbPeek('analytics.searches_v2', 'prod')
vbPeek('analytics.searches', 'prod')
vbPeek('event.vb_search_log')
vbQuery("select distinct mechanism from storyblocks.subscription_campaign_profiles")
library(vb)
vbQuery("select distinct mechanism from storyblocks.subscription_campaign_profiles")
vbQuery("select distinct channel_name from storyblocks.subscription_campaign_profiles where mechanism is not null")
test = vbQuery("select distinct channel_name, mechanism from storyblocks.subscription_campaign_profiles")
head(test)
tail(test)
test %>%
filter(channel_name != 'Affiliate')
library(tidyverse)
test %>%
filter(channel_name != 'Affiliate')
test %>%
filter(channel_name != 'Affiliate') %>%
arrange(channel_name)
test = vbQuery("select distinct channel_name, vertical from storyblocks.subscription_campaign_profiles")
test
test = vbQuery("select vertical, count(*) from storyblocks.subscription_campaign_profiles group by 1 order by 2 desc limit 10")
test
vbPeek('storyblocks.lead_campaign_profiles')
vbPeek('storyblocks.lead_campaign_profiles')
library(vb)
vbPeek('storyblocks.stock_items')
library(vb)
vbQuery("select * from wasabi.stock_items where contributor_portal_id = 'HTj88dJU-j5dutf3f' limit 5")
vbPeek('wasabi.stock_items')
vbQuery("select * from wasabi.stock_items where contributor_portal_user_id = 'HTj88dJU-j5dutf3f' limit 5")
test = vbQuery("select count(*) from wasabi.stock_items where contributor_portal_user_id = 'HTj88dJU-j5dutf3f'")
test
vbQuery("select count(*) from wasabi.stock_items where contributor_portal_user_id = 'HTj88dJU-j5dutf3f' and review_pending is null")
vbQuery("select max(review_uploaded) from wasabi.stock_items where contributor_portal_user_id = 'HTj88dJU-j5dutf3f' and review_pending is null")
vbQuery("select count(*) from wasabi.stock_items where contributor_portal_user_id = 'rS5r4eB' and review_pending is null")
vbQuery("select count(*) from wasabi.stock_items where contributor_portal_user_id = 'rS5r4eB'")
vbPeek('wasabi.users')
vbPeek('wasabi.users', 'prod')
vbPeek('wasabi.stock_items')
library(vb)
vbQuery("select * from analytics.page_views limit 4")
vbQuery("select * from analytics.sessions limit 4")
vbQuery("
select
date_trunc('month', session_begin) as month
, function.f_parse_utm(campaign, 5) as product_hook
, count(*) as sessions
from analytics.sessions
group by 1,2
limit 5
")
vbQuery("
select
date_trunc('month', session_begin) as month
, campaign
, function.f_parse_utm(campaign, 5) as product_hook
, count(*) as sessions
from analytics.sessions
group by 1,2,3
limit 5
")
test = vbQuery("
select
date_trunc('month', session_begin) as month
, campaign
, count(*) as sessions
from analytics.sessions
group by 1,2,3
")
test = vbQuery("
select
date_trunc('month', session_begin) as month
, campaign
, count(*) as sessions
from analytics.sessions
group by 1,2
")
head(test)
test %>%
mutate(hook = substr(campaign, nchar(campaign) - 4, campaign)) %>%
head
library(tidyverse)
test %>%
mutate(hook = substr(campaign, nchar(campaign) - 4, campaign)) %>%
head
test %>%
mutate(hook = substr(campaign, nchar(campaign) - 4, nchar(campaign))) %>%
head
library(stringr)
str_extract('VB-Search-AfterEffects-ASA-FT', '^.*-\s*(.*)$')
str_extract('VB-Search-AfterEffects-ASA-FT', '^.*-\\s*(.*)$')
str_extract_all('VB-Search-AfterEffects-ASA-FT', '^.*-\\s*(.*)$')
str_extract('VB-Search-AfterEffects-ASA-FT', '^.*-\\s*$')
str_extract('VB-Search-AfterEffects-ASA-FT', '^.*-\\s$')
str_extract('VB-Search-AfterEffects-ASA-FT', '^.*-$')
str_extract('VB-Search-AfterEffects-ASA-FT', '.*-$')
str_extract('VB-Search-AfterEffects-ASA-FT', '-FT|-99')
str_extract('VB-Search-AfterEffects-ASA-FT', '-FT|-99|-149')
str_replace(str_extract('VB-Search-AfterEffects-ASA-FT', '-FT|-99|-149'), '-', '')
str_replace(str_extract('VB-Search-AfterEffects-ASA-FT', '-FT|-99|-149'), '-', '')
test %>%
str_replace(str_extract(campaign, '-FT|-99|-149'), '-', '')
test %>%
str_replace(str_extract(campaign, '-FT|-99|-149'), '-', '')
test %>%
rowwise %>%
str_replace(str_extract(campaign, '-FT|-99|-149'), '-', '') %>%
head
str_replace(str_extract(campaign, '-FT|-99|-149'), '-', '')
campaign = 'VB-Search-AfterEffects-ASA-FT'
str_replace(str_extract(campaign, '-FT|-99|-149'), '-', '')
test %>%
rowwise %>%
str_replace(str_extract(., campaign, '-FT|-99|-149'), '-', '') %>%
head
test %>%
mutate(hook = str_replace(str_extract(campaign, '-FT|-99|-149'), '-', '')) %>%
head
library(highcharter)
test %>%
mutate(hook = str_replace(str_extract(campaign, '-FT|-99|-149'), '-', ''),
month = as.Date(month)) %>%
arrange(date) %>%
hchart(hcaes(x = month, y = sessions, group = hook), type = 'line')
test %>%
mutate(hook = str_replace(str_extract(campaign, '-FT|-99|-149'), '-', ''),
month = as.Date(month)) %>%
arrange(date)
test %>%
mutate(hook = str_replace(str_extract(campaign, '-FT|-99|-149'), '-', ''),
month = as.Date(month)) %>%
arrange(month) %>%
hchart(hcaes(x = month, y = sessions, group = hook), type = 'line')
test %>%
mutate(hook = str_replace(str_extract(campaign, '-FT|-99|-149'), '-', ''),
month = as.Date(month)) %>%
group_by(month, hook) %>%
summarise(sessions = sum(sessions)) %>%
hchart(hcaes(x = month, y = sessions, group = hook), type = 'line')
test %>%
filter(month >= '2017-04-01') %>%
mutate(hook = str_replace(str_extract(campaign, '-FT|-99|-149'), '-', ''),
month = as.Date(month)) %>%
group_by(month, hook) %>%
summarise(sessions = sum(sessions)) %>%
hchart(hcaes(x = month, y = sessions, group = hook), type = 'line')
test = vbQuery("
select
date_trunc('month', session_begin) as month
, campaign
, count(*) as sessions
from analytics.sessions
group by 1,2
", 'prod')
test %>%
filter(month >= '2017-04-01') %>%
mutate(hook = str_replace(str_extract(campaign, '-FT|-99|-149'), '-', ''),
month = as.Date(month)) %>%
group_by(month, hook) %>%
summarise(sessions = sum(sessions)) %>%
hchart(hcaes(x = month, y = sessions, group = hook), type = 'line')
test %>%
filter(month >= '2017-04-01', month <= '2017-11-01') %>%
mutate(hook = str_replace(str_extract(campaign, '-FT|-99|-149'), '-', ''),
month = as.Date(month)) %>%
group_by(month, hook) %>%
summarise(sessions = sum(sessions)) %>%
hchart(hcaes(x = month, y = sessions, group = hook), type = 'line')
test %>%
filter(month >= '2017-04-01', month <= '2017-11-01') %>%
mutate(hook = str_replace(str_extract(campaign, '-FT|-99|-149'), '-', ''),
month = as.Date(month)) %>%
group_by(month, hook) %>%
head
test = vbQuery("
select
date_trunc('month', session_begin) as month
, campaign
, channel
, count(*) as sessions
from analytics.sessions
group by 1,2,3
", 'prod')
test %>%
filter(month >= '2017-04-01', month <= '2017-11-01') %>%
mutate(hook = str_replace(str_extract(campaign, '-FT|-99|-149'), '-', ''),
month = as.Date(month)) %>%
group_by(month, hook) %>%
head
test %>%
filter(month >= '2017-04-01', month <= '2017-11-01') %>%
mutate(hook = str_replace(str_extract(campaign, '-FT|-99|-149'), '-', ''),
month = as.Date(month)) %>%
group_by(month, hook, channel) %>%
summarise(sessions = sum(sessions))
test %>%
filter(month >= '2017-04-01', month <= '2017-11-01') %>%
mutate(hook = str_replace(str_extract(campaign, '-FT|-99|-149'), '-', ''),
month = as.Date(month)) %>%
group_by(month, hook, channel) %>%
summarise(sessions = sum(sessions)) %>%
ungroup %>%
filter(is.na(hook))
test %>%
filter(month >= '2017-04-01', month <= '2017-11-01') %>%
mutate(hook = str_replace(str_extract(campaign, '-FT|-99|-149'), '-', ''),
month = as.Date(month)) %>%
group_by(month, hook, channel) %>%
summarise(sessions = sum(sessions)) %>%
ungroup %>%
filter(is.na(hook)) %>%
arrange(channel)
test %>%
filter(month >= '2017-04-01', month <= '2017-11-01') %>%
mutate(hook = str_replace(str_extract(campaign, '-FT|-99|-149'), '-', ''),
month = as.Date(month)) %>%
group_by(hook, channel) %>%
summarise(sessions = sum(sessions)) %>%
ungroup %>%
filter(is.na(hook)) %>%
arrange(channel)
test %>%
filter(month >= '2017-04-01', month <= '2017-11-01') %>%
mutate(hook = str_replace(str_extract(campaign, '-FT|-99|-149'), '-', ''),
month = as.Date(month)) %>%
group_by(hook, channel) %>%
summarise(sessions = sum(sessions)) %>%
ungroup %>%
filter(is.na(hook)) %>%
arrange(-sessions)
test %>%
filter(month >= '2017-04-01', month <= '2017-11-01') %>%
mutate(hook = str_replace(str_extract(campaign, '-FT|-99|-149'), '-', ''),
month = as.Date(month)) %>%
group_by(hook, channel) %>%
summarise(sessions = sum(sessions)) %>%
ungroup %>%
filter(is.na(hook)) %>%
arrange(-sessions) %>%
mutate(pct = sessions = sum(sessions))
test %>%
filter(month >= '2017-04-01', month <= '2017-11-01') %>%
mutate(hook = str_replace(str_extract(campaign, '-FT|-99|-149'), '-', ''),
month = as.Date(month)) %>%
group_by(hook, channel) %>%
summarise(sessions = sum(sessions)) %>%
ungroup %>%
filter(is.na(hook)) %>%
arrange(-sessions) %>%
mutate(pct = sessions/ sum(sessions))
50 + 39 + 4
test %>%
filter(month >= '2017-04-01', month <= '2017-11-01') %>%
mutate(hook = str_replace(str_extract(campaign, '-FT|-99|-149'), '-', ''),
month = as.Date(month)) %>%
group_by(hook, channel) %>%
summarise(sessions = sum(sessions)) %>%
ungroup
list.files()
list.files()
library(vb)
vbPeek('storyblocks.payments')
vbPeek('storyblocks.payments', 'prod')
vbQuery
vbQuery("
WITH corp_sub_admins AS (
SELECT
aus.id   AS parent_user_id,
count(*) AS num_sub_members
FROM storyblocks.submemberships vmsm
JOIN storyblocks.subscriptions aus
ON aus.id = vmsm.parent_subscription_id
WHERE aus.status IN ('donotbill')
GROUP BY 1
)
SELECT
aus.site_id,
aus.plan_id,
aus.email,
aus.is_edu_account,
csa.num_sub_members,
'' AS is_corp_sub
FROM corp_sub_admins csa
JOIN storyblocks.subscriptions aus
ON aus.id = csa.parent_user_id
ORDER BY 1, 4 DESC
;
")
vbQuery("
WITH corp_sub_admins AS (
SELECT
s.id   AS parent_user_id,
count(*) AS num_sub_members
FROM storyblocks.submemberships vmsm
JOIN storyblocks.subscriptions aus
ON s.id = vmsm.parent_subscription_id
WHERE s.status IN ('donotbill')
and s.is_edu_account = 0
GROUP BY 1
)
SELECT
s.site_id,
s.plan_id,
s.email,
s.is_edu_account,
csa.num_sub_members,
'' AS is_corp_sub
FROM corp_sub_admins csa
JOIN storyblocks.subscriptions s
ON s.id = csa.parent_user_id
ORDER BY 1, 4 DESC
;
")
vbQuery("
WITH corp_sub_admins AS (
SELECT
s.id   AS parent_user_id,
count(*) AS num_sub_members
FROM storyblocks.submemberships vmsm
JOIN storyblocks.subscriptions s
ON s.id = vmsm.parent_subscription_id
WHERE s.status IN ('donotbill')
and s.is_edu_account = 0
GROUP BY 1
)
SELECT
s.site_id,
s.plan_id,
s.email,
s.is_edu_account,
csa.num_sub_members,
'' AS is_corp_sub
FROM corp_sub_admins csa
JOIN storyblocks.subscriptions s
ON s.id = csa.parent_user_id
ORDER BY 1, 4 DESC
;
")
rm(list = ls())
library(vb)
library(tidyverse)
vbPeek('wasabi.stock_items')
vbPeek('wasabi.stock_items')
vbPeek('wasabi.stock_items')
vbPeek('storyblocks.stock_items')
vbPeek("analytics.shopping_cart_purchaes")
vbPeek("analytics.shopping_cart_purchases")
vbPeek("analytics.shopping_cart_purchases")
vbPeek("storyblocks.shopping_cart_purchases")
vbPeek("storyblocks.shopping_carts")
vbPeek("storyblocks.stock_item_purchases")
vbPeek("storyblocks.stock_item_downloads")
vbPeek('storyblocks.shopping_cart_purchase_stock_items')
vbPeek('storyblocks.stock_contributors')
vbPeek('storyblocks.stock_items')
vbPeek('storyblocks.shopping_cart_purchase_stock_items')
vbPeek('wasabi.stock_items')
vbQuery("select distinct media_type from si.stock_items")
vbPeek('wasabi.users')
vbPeek('wasabi.stock_items')
vbTables('storyblocks')
vbTables('storyblocks') %>%
filter(grepl('payout', table_name))
vbTables('storyblocks') %>%
filter(grepl('contr', table_name))
vbTables('storyblocks') %>%
filter(grepl('commis', table_name))
vbTables('videoblocks') %>%
filter(grepl('commis', table_name))
vbTables('videoblocks') %>%
filter(grepl('pay', table_name))
vbTables('videoblocks') %>%
filter(grepl('payou', table_name))
vbPeek('analytics.contributor_sales')
vbPeek('storyblocks.shopping_cart_purchases_stock_kems')
vbPeek('storyblocks.shopping_cart_purchases_stock_items')
vbPeek('storyblocks.shopping_cart_purchase_stock_items')
vbPeek('wasabi.stock_items')
shiny::runApp('Documents/midnightBarber/test_message')
runApp('Documents/midnightBarber/test_message')
runApp('Documents/midnightBarber/test_message')
runApp('Documents/midnightBarber/test_message')
runApp('Documents/midnightBarber/test_message')
runApp('Documents/midnightBarber/test_message')
runApp('Documents/midnightBarber/test_message')
runApp('Documents/midnightBarber/test_message')
runApp('Documents/midnightBarber/test_message')
runApp('Documents/midnightBarber/test_message')
runApp('Documents/midnightBarber/test_message')
runApp('Documents/midnightBarber/test_message')
?box
?box
runApp('Documents/midnightBarber/test_message')
runApp('Documents/midnightBarber/test_message')
runApp('Documents/midnightBarber/test_message')
runApp('Documents/midnightBarber/test_message')
runApp('Documents/midnightBarber/test_message')
runApp('Documents/midnightBarber/test_message')
runApp('Documents/midnightBarber/test_message')
?shinydashboard::box
shiny::runApp('Documents/midnightBarber/test_message')
shinydashboard::box
shiny::runApp('Documents/midnightBarber/shiny-server/music_map')
runApp('Documents/midnightBarber/shiny-server/music_map')
rm(list = ls())
shiny::runApp('Documents/midnightBarber/shiny-server/music_map')
selected_map_metric
countries[[selected_map_metric]]
countries[[selected_map_metric]]
countries[[selected_map_metric]]
countries[[selected_map_metric]]
countries[,selected_map_metric]
countries[,selected_map_metric]
countries[,selected_map_metric][[1]]
rm(list = ls*)
rm(list = ls())
shiny::runApp('Documents/midnightBarber/shiny-server/music_map')
rm(list = ls*)
rm(list = ls())
shiny::runApp('Documents/midnightBarber/shiny-server/music_map')
selected_map_metric
countries
countries[[selected_map_metric]]
countries[[selected_map_metric]]
countries %>% head
countries %>% as.data.frame()
countries %>% as.data.frame() %>% select(danceability)
as.data.frame(countries)[[selected_map_metric]]
runApp('Documents/midnightBarber/shiny-server/music_map')
rm(list = ls())
shiny::runApp('Documents/midnightBarber/shiny-server/music_map')
rm(list = ls*)
rm(list = ls())
rm(list = ls*())
rm(list = ls())
shiny::runApp('Documents/midnightBarber/shiny-server/music_map')
getwd()
runApp('Documents/midnightBarber/shiny-server/music_map')
runApp('Documents/midnightBarber/shiny-server/music_map')
runApp('Documents/midnightBarber/shiny-server/music_map')
mouseover_country
geo_tracks$country_abb
geo_tracks$country_abb[geo_tracks$iso3c == mouseover_country$id]
geo_tracks$country_abb[geo_tracks$iso3c == mouseover_country$id] %>% unique
tolower(unique(geo_tracks$country_abb[geo_tracks$iso3c == mouseover_country$id]))
runApp('Documents/midnightBarber/shiny-server/music_map')
geo_tracks$country
runApp('Documents/midnightBarber/shiny-server/music_map')
countries
countries$id
countries
country_features
countries[[1]]
countries[[2]]
countries[[3]]
countries[[1]]
countrycode::countrycode_data
countrycode::countrycode_data$iso3c
countrycode::countrycode_data$iso3n
countrycode::countrycode_data$iso3c
countrycode::countrycode_data$iso2c
library(countrycode)
countrycode_data$country.name.en
countrycode_data$country.name.en[countrycode_data$iso3c == mouseover_country]
countrycode_data$iso3c == mouseover_country
countrycode_data$country.name.en[countrycode_data$iso3c == mouseover_country]
unique(countrycode_data$country.name.en[countrycode_data$iso3c == mouseover_country])
coalesce(unique(countrycode_data$country.name.en[countrycode_data$iso3c == mouseover_country]))
unique(countrycode_data$country.name.en[countrycode_data$iso3c == mouseover_country]) %>% drop_na()
country_name <- unique(countrycode_data$country.name.en[countrycode_data$iso3c == mouseover_country])
country_name <- country_name[!is.na(country_name)]
country_name
iso2c <- unique(countrycode_data$iso2c[countrycode_data$iso3c == mouseover_country])
iso2c
iso2c <- iso2c[!is.na(iso2c)]
iso2c
runApp('Documents/midnightBarber/shiny-server/music_map')
head(geo_tracks)
View(geo_tracks)
head(geo_tracks)
runApp('Documents/midnightBarber/shiny-server/music_map')
rm(list = ls*)
rm(list = ls())
runApp('Documents/midnightBarber/bizsci/keras-customer-churn')
Hmisc::capitalize('hi')
install.packages('Hmisc')
Hmisc::capitalize('hi')
runApp('Documents/midnightBarber/bizsci/keras-customer-churn')
runApp('Documents/midnightBarber/bizsci/keras-customer-churn')
